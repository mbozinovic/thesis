"0","library(mapproj)"
"2","Loading required package: maps
"
"2","
Attaching package: â€˜mapsâ€™

"
"2","The following object is masked from â€˜package:purrrâ€™:

    map

"
"0","drift <- track_BB_OL_10"
"0",""
"0","# Get bathymetry (code from Ocean Tracking Network #https://www.youtube.com/watch?v=xT2F-Y9bKLk)"
"0","bgo <- getNOAA.bathy(lon1 = min(drift$long-0.7), lon2 = max(drift$long + 0.7),"
"0","                     lat1 = min(drift$lat-0.7), lat2=max(drift$lat + 0.7), resolution = 1)"
"2","Querying NOAA database ...
"
"2","This may take seconds to minutes, depending on grid size

"
"2","trying URL 'https://gis.ngdc.noaa.gov/arcgis/rest/services/DEM_mosaics/DEM_all/ImageServer/exportImage?bbox=-125.8,35.1,-122,37.5&bboxSR=4326&size=227,141&imageSR=4326&format=tiff&pixelType=F32&interpolation=+RSP_NearestNeighbor&compression=LZ77&renderingRule={%22rasterFunction%22:%22none%22}&mosaicRule={%22where%22:%22Name=%27ETOPO_2022_v1_60s_bed%27%22}&f=image'
"
"2","Content type 'image/tiff'"
"2"," length 126930 bytes (123 KB)
"
"2","downloaded 123 KB

"
"2","Building bathy matrix ...
"
"0","# Create basemap"
"0","#bf <- fortify.bathy(bgo, geom=c(""r"", ""c"")) + scale_fill_etopo() # converts bathy object to data frame "
"0","# ABOVE DOESNT WORK"
"0","bplot <- autoplot(bgo, geom = c(""raster"", ""contour""), coast = TRUE) + "
"0","  scale_fill_etopo() #creates ggplot object"
"0",""
"0","# Plot drift"
"0","p <- bplot + "
"0","  geom_path(data = drift, "
"0","            aes(x=long,y=lat,group=spotID), "
"0","            alpha = 0.5) +"
"0","  geom_point(data = drift, "
"0","             aes(x=long,y=lat,group=spotID, size = OL_125, color = OL_125),"
"0","             shape=19, stroke = 1) +"
"0",""
"0","  #formatting  "
"0","  scale_color_viridis_c(option = ""inferno"") +"
"0","  scale_size_continuous(range = c(0.1,10)) +"
"0","  labs(x=NULL, y=NULL, "
"0","       fill = 'Depth',"
"0","       color = 'OL 125')+"
"0","  theme(panel.grid = element_blank())"
"0",""
"0","# Plot AIS"
"0","b <- bplot + "
"0","  geom_point(data = AIS_sf, mapping = aes(x=LON,y=LAT, group = VesselName)) +"
"0","  scale_x_continuous(limits = c(min(drift$long-0.7), max(drift$long + 0.7))) + "
"0","  scale_y_continuous(limits = c(min(drift$lat-0.7), max(drift$lat + 0.7))) +"
"0","  theme(panel.grid = element_blank())"
"2","[38;5;232mScale for [32mx[38;5;232m is already present.
Adding another scale for [32mx[38;5;232m, which will replace the existing scale.[39m"
"2","[38;5;232mScale for [32my[38;5;232m is already present.
Adding another scale for [32my[38;5;232m, which will replace the existing scale.[39m"
"0","# Plot AIS + drift"
"0","z <- bplot +"
"0","  geom_point(data = AIS_sf, mapping = aes(x=LON,y=LAT, group = VesselName)) +"
"0","  geom_path(data = drift, "
"0","            aes(x=long,y=lat,group=spotID), "
"0","            alpha = 0.5) +"
"0","  geom_point(data = drift, "
"0","             aes(x=long,y=lat,group=spotID, size = OL_125, color = OL_125),"
"0","             shape=19, stroke = 1) +"
"0","  #formatting  "
"0","  scale_color_viridis_c(option = ""inferno"") +"
"0","  scale_size_continuous(range = c(0.1,10)) +"
"0","  labs(x=NULL, y=NULL, "
"0","       fill = 'Depth',"
"0","       color = 'OL 125')+"
"0","  scale_x_continuous(limits = c(min(drift$long-0.7), max(drift$long + 0.7))) + "
"0","  scale_y_continuous(limits = c(min(drift$lat-0.7), max(drift$lat + 0.7)))"
"2","[38;5;232mScale for [32mx[38;5;232m is already present.
Adding another scale for [32mx[38;5;232m, which will replace the existing scale.[39m"
"2","[38;5;232mScale for [32my[38;5;232m is already present.
Adding another scale for [32my[38;5;232m, which will replace the existing scale.[39m"
