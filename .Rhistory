summarize(sst_mean = mean(sst_mean),
dist_slope = mean(dist2slope),
depth = mean(depth),
slope = mean(bathy_slope),
dist_shore = mean(dist2shore),
chlorophyll_mean = mean(chlorophyll_mean),
ssh_mean = mean(ssh_mean),
mldDepth = mean(mldDepth),
mldTemp = mean(mldTemp),
ttDepth = mean(ttDepth),
ttTemp = mean(ttTemp),
temp400 = mean(temp400),
sal400 = mean(sal400),
curlmean = mean(curl_mean),
Wh_presence = sum(Wpresence))
View(means)
#Get avg daily environmental variables
means <- allDrifts %>%
group_by(as.Date(UTC))%>%
summarize(sst_mean = mean(sst_mean),
dist_slope = mean(dist2slope),
depth = mean(depth),
slope = mean(bathy_slope),
dist_shore = mean(dist2shore),
chlorophyll_mean = mean(chlorophyll_mean),
ssh_mean = mean(ssh_mean),
mldDepth = mean(mldDepth),
mldTemp = mean(mldTemp),
ttDepth = mean(ttDepth),
ttTemp = mean(ttTemp),
temp400 = mean(temp400),
sal400 = mean(sal400),
curlmean = mean(curl_mean),
Wh_presence = sum(Wpresence))
View(means)
#For surface/depth variables USING DAILY MEAN VARIABLES
trackLong <- means %>%
pivot_longer(cols = sst_mean:ssh_mean,
names_to="parameter",
values_to="value") %>%
filter(parameter %in% c("sst_mean", "dist_shore", "chlorophyll_mean", "ssh_mean")) %>%
rename(Date = `as.Date(UTC)`)
p <- ggplot(data = trackLong, aes(x = Date, y = value)) +
geom_line()
p + facet_grid(parameter ~ ., scales = "free_y")
# For MLD/Thermocline variables
trackLong2 <- allDrifts %>%
pivot_longer(cols = mldDepth:sal400,
names_to="parameter",
values_to="value") %>%
filter(parameter %in% c("mldDepth", "mldTemp", "ttDepth", "ttTemp", "temp400", "sal400")) %>%
rename(Date = UTC) %>%
subset(species!="?BW")
q <- ggplot(data = trackLong2, aes(x = Date, y = value)) +
geom_line() + geom_point(aes(color = species)) + scale_color_discrete(na.translate=FALSE)
q + facet_grid(parameter ~ ., scales = "free_y")
# For temp400 and salinity400 variables
env.labs <- c(`sal400` = "Salinity at 400m",
`temp400` = "Temperature at 400m")
trackLong3 <- allDrifts %>%
pivot_longer(cols = temp400:sal400,
names_to="parameter",
values_to="value") %>%
filter(parameter %in% c("temp400", "sal400")) %>%
rename(`Date (2018)` = UTC)
q <- ggplot(data = trackLong3, aes(x = `Date (2018)`, y = value)) +
#geom_line() +
geom_point(aes(color = species)) +
scale_color_discrete(na.translate=FALSE, labels = c("ZC" = "Cuvier's", "BW43" = "BW43", "BW" = "BW"))
q + facet_grid(parameter ~ ., scales = "free_y", labeller = as_labeller(env.labs))
no_na <- allDrifts %>% filter(Wpresence == 1) %>%
mutate(HrsafterShip = timeAfterShip /3600)
ggplot(no_na) + geom_histogram(aes(x = HrsafterShip), bins = 30) + facet_grid(species ~.)
ggplot(no_na) + geom_histogram(aes(x = HrsafterShip), bins = 30) + facet_grid(species ~.) +
labs(title = "Hours Elapsed from Ship Event by Species")
ggplot(no_na) + geom_histogram(aes(x = HrsafterShip), bins = 30) + facet_grid(species ~.) +
labs(title = "Hours Elapsed from Ship Event by Species - All buoys")
#pdf(paste("timeSeries8-31",".pdf"), width=14, height=10)
### Buoy 7 ####
W.07 <- GPSwhaleAISenvSS07 %>%
select(UTC, Wpresence, species) %>%
filter(species == "ZC")
W.07plot <- plotPresGrid(W.07, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS07, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 7: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.07, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS07$UTC),
end = max(GPSwhaleAISenvSS07$UTC), fill = NA, color = "white")
# Create plot with TOL125
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
t1 <- plotTimeseries(GPSwhaleAISenvSS07, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 7: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.07, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS07$UTC),
end = max(GPSwhaleAISenvSS07$UTC), fill = NA, color = "white")
# Create plot with TOL2000
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
###### Buoy 8 ####
W.08 <- GPSwhaleAISenvSS08 %>%
select(UTC, Wpresence, species) %>%
filter(species == "ZC")
W.08plot <- plotPresGrid(W.08, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS08, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 8: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.08, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS08$UTC),
end = max(GPSwhaleAISenvSS08$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS08, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 8: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.08, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS08$UTC),
end = max(GPSwhaleAISenvSS08$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
#### Buoy 10  ######
W.10 <- GPSwhaleAISenvSS10 %>%
select(UTC, Wpresence, species) %>%
filter(species == "ZC")
W.10plot <- plotPresGrid(W.10, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS10, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 10: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.10, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS10$UTC),
end = max(GPSwhaleAISenvSS10$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS10, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 10: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.10, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS10$UTC),
end = max(GPSwhaleAISenvSS10$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
## Buoy 12
W.12 <- GPSwhaleAISenvSS12 %>%
select(UTC, Wpresence, species) %>%
filter(species == "ZC")
W.12plot <- plotPresGrid(W.12, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS12, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 12: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.12, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS12$UTC),
end = max(GPSwhaleAISenvSS12$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS12, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 12: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.12, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS12$UTC),
end = max(GPSwhaleAISenvSS12$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
## Buoy 13
W.13 <- GPSwhaleAISenvSS13 %>%
select(UTC, Wpresence, species) %>%
filter(species == "ZC")
W.13plot <- plotPresGrid(W.13, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS13, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 13: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.13, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS13$UTC),
end = max(GPSwhaleAISenvSS13$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS13, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 13: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.13, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS13$UTC),
end = max(GPSwhaleAISenvSS13$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
## Buoy 14
W.14 <- GPSwhaleAISenvSS14 %>%
select(UTC, Wpresence, species) %>%
filter(species == "ZC")
W.14plot <- plotPresGrid(W.14, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS14, column='TOL_125', bin='hour', style = 'heatmap', title='Buoy 14: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.14, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS14$UTC),
end = max(GPSwhaleAISenvSS14$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS14, column='TOL_2000', bin='hour', style = 'heatmap', title='Buoy 14: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.14, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS14$UTC),
end = max(GPSwhaleAISenvSS14$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
## Buoy 16
W.16 <- GPSwhaleAISenvSS16 %>%
select(UTC, Wpresence, species) %>%
filter(species == "ZC")
W.16plot <- plotPresGrid(W.16, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS16, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 16: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.16, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS16$UTC),
end = max(GPSwhaleAISenvSS16$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS16, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 16: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.16, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS16$UTC),
end = max(GPSwhaleAISenvSS16$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
## Buoy 18
W.18 <- GPSwhaleAISenvSS18 %>%
select(UTC, Wpresence, species) %>%
filter(species == "ZC")
W.18plot <- plotPresGrid(W.18, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS18, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 18: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.18, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS18$UTC),
end = max(GPSwhaleAISenvSS18$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS18, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 18: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.18, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS18$UTC),
end = max(GPSwhaleAISenvSS18$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
## Buoy 19
W.19 <- GPSwhaleAISenvSS19 %>%
select(UTC, Wpresence, species) %>%
filter(species == "ZC")
W.19plot <- plotPresGrid(W.19, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS19, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 19: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.19, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS19$UTC),
end = max(GPSwhaleAISenvSS19$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS19, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 19: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.19, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS19$UTC),
end = max(GPSwhaleAISenvSS19$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
## Buoy 20
W.20 <- GPSwhaleAISenvSS20 %>%
select(UTC, Wpresence, species) %>%
filter(species == "ZC")
W.20plot <- plotPresGrid(W.20, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS20, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 20: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.20, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS20$UTC),
end = max(GPSwhaleAISenvSS20$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS20, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 20: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.20, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS20$UTC),
end = max(GPSwhaleAISenvSS20$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
## Buoy 21
W.21 <- GPSwhaleAISenvSS21 %>%
select(UTC, Wpresence, species) %>%
filter(species == "ZC")
W.21plot <- plotPresGrid(W.21, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS21, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 21: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.21, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS21$UTC),
end = max(GPSwhaleAISenvSS21$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS21, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 21: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.21, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS21$UTC),
end = max(GPSwhaleAISenvSS21$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
## Buoy 12
W.22 <- GPSwhaleAISenvSS22 %>%
select(UTC, Wpresence, species) %>%
filter(species == "PM")
W.22plot <- plotPresGrid(W.22, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS22, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 22: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.22, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS22$UTC),
end = max(GPSwhaleAISenvSS22$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS22, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 22: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.22, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS22$UTC),
end = max(GPSwhaleAISenvSS22$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
## Buoy 23
W.23 <- GPSwhaleAISenvSS23 %>%
select(UTC, Wpresence, species) %>%
filter(species == "ZC")
W.23plot <- plotPresGrid(W.23, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS23, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 23: TOL 125 Plot + ZC'))
g2 <- plotPresGrid(W.23, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS23$UTC),
end = max(GPSwhaleAISenvSS23$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS23, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 23: TOL 2000 Plot + ZC')
t2 <- plotPresGrid(W.23, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS23$UTC),
end = max(GPSwhaleAISenvSS23$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
hourly <- GPSwhaleAISenvSS10 %>% group_by(time = floor_date(UTC, '4 hours')) %>%
summarize(mean_TOL2000 = mean(TOL_2000),
sum_AIS = sum(shipin10km),
sum_Wh = sum(Wpresence))
ggplot(hourly, aes(x = time, y = mean_TOL2000)) + geom_line() +
geom_smooth() +
geom_point() +
#geom_point(aes(color = species)) +
#geom_vline(xintercept = hourly$UTC[hourly$shipin10km == 1], color = "yellow", alpha = 0.5) +
scale_color_discrete(na.translate=FALSE) #+
# scale_x_datetime(date_breaks = "1 day",limits = as.POSIXct(c("2018-09-24 00:00:00", "2018-10-03 00:00:00")))
ggplot(allDrifts, aes(UTC, TOL_125) + geom_point()
ggplot(allDrifts, aes(UTC, TOL_125)) + geom_point()
ggplot(allDrifts, aes(UTC, TOL_125)) + geom_point(color = Deployment)
allDrifts
ggplot(allDrifts, aes(UTC, TOL_125)) + geom_line(color = "Deployment")
ggplot(allDrifts, aes(UTC, TOL_125)) + geom_line(color = Deployment)
ggplot(allDrifts, aes(UTC, TOL_125, color = Deployment)) + geom_line()
ggplot(allDrifts, aes(UTC, TOL_2000, color = Deployment)) + geom_line()
ggplot(allDrifts, aes(UTC, TOL_2000, color = Deployment)) + geom_line()
ggplot(allDrifts, aes(UTC, TOL_2000, color = Deployment)) + geom_line()
ggplot(allDrifts, aes(Latitude, TOL_2000, color = Deployment)) + geom_line()
ggplot(allDrifts, aes(TOL_2000, Latitude, color = Deployment)) + geom_line()
ggplot(allDrifts, aes(Longitude, Latitude, color = TOL_2000)) + geom_line()
ggplot(allDrifts, aes(Longitude, Latitude, color = TOL_2000)) + geom_point()
ggplot(allDrifts, aes(Longitude, Latitude, color = TOL_2000)) + geom_point()
ggplot(allDrifts, aes(Longitude, Latitude, color = TOL_2000)) + geom_point()
ggplot(allDrifts, aes(Longitude, Latitude, size = TOL_2000)) + geom_point()
ggplot(allDrifts, aes(Longitude, Latitude)) + geom_point(size = TOL_2000)
ggplot(allDrifts, aes(Longitude, Latitude)) + geom_point(size = `TOL_2000`)
ggplot(allDrifts, aes(Longitude, Latitude)) + geom_point(size = "TOL_2000")
ggplot(allDrifts, aes(Longitude, Latitude, color = TOL_2000)) + geom_point()
ggplot(allDrifts, aes(UTC,TOL_2000)) + geom_point()
# Sound levels for all species
ggplot(detsOnly3) + geom_boxplot(aes(x = species, y = TOL_125))
ggplot(detsOnly3) + geom_boxplot(aes(x = species, y = TOL_2000))
# Sound levels for all species
ggplot(detsOnly3) + geom_boxplot(aes(x = species, y = TOL_125)) +
labs(title = "TOL 125 Sound levels by Species - All Buoys")
ggplot(detsOnly3) + geom_boxplot(aes(x = species, y = TOL_2000)) +
labs(title = "TOL 2000 Sound levels by Species - All Buoys")
###### Buoy 8 ####
W.08 <- GPSwhaleAISenvSS08 %>%
select(UTC, Wpresence, species) %>%
filter(species == "PM")
W.08plot <- plotPresGrid(W.08, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS08, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 8: TOL 125 Plot + PM'))
g2 <- plotPresGrid(W.08, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS08$UTC),
end = max(GPSwhaleAISenvSS08$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS08, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 8: TOL 2000 Plot + PM')
t2 <- plotPresGrid(W.08, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS08$UTC),
end = max(GPSwhaleAISenvSS08$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
## Buoy 12
W.12 <- GPSwhaleAISenvSS12 %>%
select(UTC, Wpresence, species) %>%
filter(species == "PM")
W.12plot <- plotPresGrid(W.12, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS12, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 12: TOL 125 Plot + PM'))
g2 <- plotPresGrid(W.12, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS12$UTC),
end = max(GPSwhaleAISenvSS12$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS12, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 12: TOL 2000 Plot + PM')
t2 <- plotPresGrid(W.12, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS12$UTC),
end = max(GPSwhaleAISenvSS12$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
## Buoy 14
W.14 <- GPSwhaleAISenvSS14 %>%
select(UTC, Wpresence, species) %>%
filter(species == "PM")
W.14plot <- plotPresGrid(W.14, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS14, column='TOL_125', bin='hour', style = 'heatmap', title='Buoy 14: TOL 125 Plot + PM'))
g2 <- plotPresGrid(W.14, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS14$UTC),
end = max(GPSwhaleAISenvSS14$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS14, column='TOL_2000', bin='hour', style = 'heatmap', title='Buoy 14: TOL 2000 Plot + PM')
t2 <- plotPresGrid(W.14, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS14$UTC),
end = max(GPSwhaleAISenvSS14$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
#### Buoy 10  ######
W.10 <- GPSwhaleAISenvSS10 %>%
select(UTC, Wpresence, species) %>%
filter(species == "PM")
W.10plot <- plotPresGrid(W.10, bin = 'hour', type = 'presence')
g1 <- (plotTimeseries(GPSwhaleAISenvSS10, column='TOL_125', bin='1hour', style = 'heatmap', title='Buoy 10: TOL 125 Plot + PM'))
g2 <- plotPresGrid(W.10, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS10$UTC),
end = max(GPSwhaleAISenvSS10$UTC), fill = NA, color = "white")
combined.g <- g1
combined.g$layers <- c(combined.g$layers, g2$layers)
#####
t1 <- plotTimeseries(GPSwhaleAISenvSS10, column='TOL_2000', bin='1hour', style = 'heatmap', title='Buoy 10: TOL 2000 Plot + PM')
t2 <- plotPresGrid(W.10, bin = 'hour', type = 'presence', start = min(GPSwhaleAISenvSS10$UTC),
end = max(GPSwhaleAISenvSS10$UTC), fill = NA, color = "white")
combined.t <- t1
combined.t$layers <- c(combined.t$layers, t2$layers)
combined.g + combined.t
?mutate
1000 / 1
1000 / 2
2 * @
2 * 2
1000$\frac{1}{1000}$
?matchEnvData
env20
GPSwhaleAISenv07
library(tidyverse)
library(mgcv)
model3 <- gam(Wpresence ~ depth + TOL_125 + dist2shore + mldTemp,
data = allDrifts, family = binomial)
#plot(model3)
#try fitting linear model
lm_depth <- lm(Wpresence ~ depth, data = GPSwhaleAISenvSS10)
ggplot(allDrifts, aes(sst_mean, chlorophyll_mean)) +
geom_point() +
geom_smooth()
# Environ only
model1 <- gam(Wpresence>0 ~ depth + sst_mean + curl_mean + ttDepth + sal400,
data = GPSwhaleAISenvSS23, family = binomial, method = "REML")
plot(model1, trans = plogis, all.terms = TRUE)
k.check(model1)
summary(model1)
gam.check(model1)
# Add soundscape metrics to model 1
model2 <- gam(Wpresence>0 ~ depth + sst_mean + curl_mean + ttDepth + sal400
+ TOL_125 + TOL_2000,
data = GPSwhaleAISenvSS10, family = binomial, method = "REML")
#plot(model2, trans = plogis) ## doesn't work
summary(model2)
gam.check(model2)
# 18.3% deviance explained (buoy 7)
# 1.25% deviance explained (buoy 8)
# 8.56% deviance explained (buoy 10)
# 1.39% deviance explained (buoy 12)
# 11.1% deviance explained (buoy 13)
# 28% deviance explained (buoy 14)
# 15% deviance explained (buoy 16)
# 9.92% deviance explained (buoy 18)
# 8.57% deviance explained (buoy 19)
# 7.3% deviance explained (buoy 20)
# 38.3% deviance explained (buoy 21)
# 15.2 % deviance explained (buoy 22)
# 20.4% deviance explained (buoy 23)
# Depth parameter only
model_depth_only <- gam(Wpresence>0 ~ depth,
data = GPSwhaleAISenvSS10, family = binomial, method = "REML")
summary(model_depth_only)
gam.check(model_depth_only)
alldriftGAM <- gam(Wpresence>0 ~ depth + sst_mean + mldTemp + ttDepth + sal400
+ TOL_125 + TOL_2000,
data = allDrifts, family = binomial, method = "REML")
summary(alldriftGAM)
gam.check(alldriftGAM)
ZC_filt <- allDrifts %>%
filter(species %in% c("ZC", NA))
ZC_filt <- allDrifts %>%
filter(species %in% c("ZC", NA))
ZC_GAM <- gam(ZC_filt>0 ~ depth + sst_mean + mldTemp + ttDepth + sal400
+ TOL_125 + TOL_2000,
data = allDrifts, family = binomial, method = "REML")
View(ZC_filt)
ZC_filt <- allDrifts %>%
filter(species %in% c("ZC", NA))
ZC_GAM <- gam(Wpresence>0 ~ depth + sst_mean + mldTemp + ttDepth + sal400
+ TOL_125 + TOL_2000,
data = ZC_filt, family = binomial, method = "REML")
summary(ZC_GAM)
gam.check(ZC_GAM)
ZC_GAM <- gam(Wpresence>0 ~ depth + sst_mean + mldTemp + ttDepth + sal400,
data = ZC_filt, family = binomial, method = "REML")
summary(ZC_GAM)
gam.check(ZC_GAM)
PM_filt <- allDrifts %>%
filter(species %in% c("PM", NA))
PM_GAM <- gam(Wpresence>0 ~ depth + sst_mean + mldTemp + ttDepth + sal400,
data = PM_filt, family = binomial, method = "REML")
summary(PM_GAM)
gam.check(PM_GAM)
ZC_GAM <- gam(Wpresence>0 ~ depth + sst_mean + mldTemp + ttDepth + sal400 + timeAfterShip,
data = ZC_filt, family = binomial, method = "REML")
summary(ZC_GAM)
ZC_GAM <- gam(Wpresence>0 ~ depth + sst_mean + mldTemp + ttDepth + sal400,
data = ZC_filt, family = binomial, method = "REML")
summary(ZC_GAM)
PM_GAM <- gam(Wpresence>0 ~ depth + sst_mean + mldTemp + ttDepth + sal400 +
TOL_125 + TOL_2000,
data = PM_filt, family = binomial, method = "REML")
summary(PM_GAM)
ZC_GAM <- gam(Wpresence>0 ~ depth + mldTemp + ttDepth + sal400,
data = ZC_filt, family = binomial, method = "REML")
summary(ZC_GAM)
PM_GAM_fiedlerVar <- gam(Wpresence>0 ~ depth + mldDepth + curl + ssh + sal400 +
TOL_125 + TOL_2000,
data = PM_filt, family = binomial, method = "REML")
PM_GAM_fiedlerVar <- gam(Wpresence>0 ~ depth + mldDepth + curl_mean + ssh + sal400,
data = PM_filt, family = binomial, method = "REML")
PM_GAM_fiedlerVar <- gam(Wpresence>0 ~ depth + mldDepth + curl_mean + ssh_mean + sal400,
data = PM_filt, family = binomial, method = "REML")
summary(PM_GAM_fiedlerVar)
summary(PM_GAM)
