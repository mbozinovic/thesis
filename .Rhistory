st_geometry_type(bplot)
class(bplot)
bplot
# Alternative basemap + drift
gplot() +
geom_sf(data = bplot)
# Alternative basemap + drift
ggplot() +
geom_sf(data = bplot)
# Alternative basemap + drift
ggplot() +
geom_raster(data = bplot)
# Alternative basemap + drift
ggplot() +
geom_map(data = bplot)
bplot <- bgo %>%
#fortify() %>%   # Turn raster into dataframe
ggplot(aes(x, y, fill = z)) +
geom_raster() +
scale_fill_etopo() # color in pixels
# Alternative basemap + drift
ggplot() +
geom_sf(data = bplot)
bgo
autoplot.bathy(bplot)
autoplot.bathy(bgo)
autoplot(bgo)
# Alternative basemap + drift
bf <- fortify.bathy(bgo)
class(bf)
ggplot() +
geom_sf(data = bf)
ggplot() +
geom_sf(data = bf)
ggplot() +
geom_sf(data = bf, mapping = aes())
ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z, breaks=c(-100), size=c(0.3), color="grey"))
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z)
ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z))
ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z, color = "gray"))
ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray")
ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray")
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=21, size = 4)
ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray")
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= spd),
alpha = 0.7, shape=21, size = 4)
ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= spd),
alpha = 0.7, shape=21, size = 4)
ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=21, size = 4) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
theme_dark()+
theme(panel.grid = element_blank())
?geom_path
ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5, lineend = butt)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=21, size = 4) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
theme_dark()+
theme(panel.grid = element_blank())
ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5, lineend = "butt")+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=21, size = 4) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
theme_dark()+
theme(panel.grid = element_blank())
ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5, lineend = "butt")+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=21, size = 4) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
#theme_dark()+
theme(panel.grid = element_blank())
p
ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=21, size = 4) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
#theme_dark()+
theme(panel.grid = element_blank())
p <- ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=21, size = 4) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
#theme_dark()+
theme(panel.grid = element_blank())
anim = p +
transition_reveal(along = date)+
ease_aes('linear')+
exit_shrink()+
ggtitle("Date: {frame_along}")
animate(anim, nframes = 60, fps = 5)
?geom_point
vignette("ggplot2-specs")
p <- ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=18, size = 4, stroke = 0) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
#theme_dark()+
theme(panel.grid = element_blank())
anim = p +
transition_reveal(along = date)+
ease_aes('linear')+
exit_shrink()+
ggtitle("Date: {frame_along}")
animate(anim, nframes = 60, fps = 5)
p <- ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=18, size = 4, stroke = 2) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
#theme_dark()+
theme(panel.grid = element_blank())
p
p <- ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=21, size = 4, stroke = 2) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
#theme_dark()+
theme(panel.grid = element_blank())
p
p <- ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=21, size = 4, stroke = 0) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
#theme_dark()+
theme(panel.grid = element_blank())
p
bgo <- getNOAA.bathy(lon1 = min(df_all$lon-0.7), lon2 = max(df_all$lon + 0.7),
lat1 = min(df_all$lat-0.7), lat2=max(df_all$lat + 0.7), resolution = 1)
# Alternative basemap + drift
bf <- fortify.bathy(bgo) # converts bathy object to data frame
p <- ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=21, size = 4, stroke = 0) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
#theme_dark()+
theme(panel.grid = element_blank())
p
anim = p +
transition_reveal(along = date)+
ease_aes('linear')+
exit_shrink()+
ggtitle("Date: {frame_along}")
animate(anim, nframes = 60, fps = 5)
p <- ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=21, size = OL125, stroke = 0) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
#theme_dark()+
theme(panel.grid = element_blank())
p <- ggplot() +
geom_contour(data = bf, mapping = aes(x=x, y=y, z=z), color = "gray") +
#lines and points
geom_path(data = df_all,
aes(x=lon,y=lat,group=spotID,color=OL125),
alpha = 0.5)+
geom_point(data = df_all,
aes(x=lon,y=lat,group=spotID,fill= OL125),
alpha = 0.7, shape=21, size = "OL125", stroke = 0) +
#formatting
scale_fill_viridis_c(option = "inferno")+
scale_color_viridis_c(option = "inferno")+
scale_size_continuous(range = c(0.1,10))+
labs(x=NULL, y=NULL,
fill = 'Speed (m/s)',
color = 'OL 125')+
#theme_dark()+
theme(panel.grid = element_blank())
p
OL125
df_all$OL125
min(df_all$OL125)
max(df_all$OL125)
bplot <- bgo %>%
fortify() %>%   # Turn raster into dataframe
ggplot(aes(x, y, fill = z)) +
geom_raster() +
scale_fill_etopo() # color in pixels
bplot
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(sf)
library(rerddap)
library(terra)
# Read in tracks, filter out lost buoys
tracks_csv <- read_csv("Data/AllTracks.csv", show_col_types = FALSE)
tracks <- tracks_csv %>%
dplyr::filter(station == "4"| station == "7"| station =="8" |station == "10"|
station == "12"|station == "13"| station == "14"| station == "16"|
station == "17"|station == "18"| station == "19"| station == "20"|
station == "21"|station == "22"| station == "23")
# Filter by CCES_08 buoy
tracks_08 <- tracks %>% dplyr::filter(station == "8")
# Round CCES_08 to nearest 20 min
tracks_08_rnd <- tracks_08 %>%
mutate(dateTime = round_date(ymd_hms(tracks_08$dateTime), "20 minutes"))
tracks_08_rnd
View(tracks)
# Tracks on a map
tracks %>% st_as_sf(coords= c("long", "lat"), crs=4326, remove=F)
tracks_sf <- tracks %>%
st_as_sf(coords= c("long", "lat"), crs=4326, remove=F)
plot(tracks_sf)
plot(tracks_sf$station)
ggplot() + geom_point(data = tracks_sf, mapping = aes(x=long,y=lat))
ggplot() + geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = station))
ggplot() + geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = station), color = station)
ggplot() + geom_point(data = tracks_sf, mapping = aes(x=long,y=lat), color = "station")
ggplot() + geom_point(data = tracks_sf, mapping = aes(x=long,y=lat), color = `station`)
ggplot() +
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, fill = station))
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, fill = as.factor(station))
ggplot() +
ggplot() +
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, fill = as.factor(station)))
ggplot() +
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station)))
library(marmap)
?getNOAA.bathy
extent(tracks_sf)
st_bbox(tracks_sf)
lon1 <- -115.78247
lon2 <- -129.04666
lat1 <- 28.21790
lat2 <- 45.09226
basemap <- getNOAA(lon1, lon2, lat1, lat2, resolution = 1)
basemap <- getNOAA.bathy(lon1, lon2, lat1, lat2, resolution = 1)
basemap
basemap <- getNOAA.bathy(lon1, lon2, lat1, lat2)
lon1 <- -129.04666
lon2 <- -115.78247
lat2 <- 28.21790
lat1 <- 45.09226
basemap <- getNOAA.bathy(lon1, lon2, lat1, lat2)
library(rnaturalearth)
lon2 <- -129.04666
lon1 <- -115.78247
lat1 <- 28.21790
lat2 <- 45.09226
basemap <- ne_countries(scale = "medium", returnclass = "sf")
ggplot() +
geom_sf() +
coord_sf(xlim = c(lon2, lon1), ylim = c(lat1, lat2), expand = FALSE)
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station)))
ggplot() +
geom_sf() +
coord_sf(xlim = c(lon2, lon1), ylim = c(lat1, lat2), expand = FALSE)
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat,
color = as.factor(station)))
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat,
color = as.factor(station)), na.rm = FALSE)
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat,
color = as.factor(station)))
ggplot() +
geom_sf() +
coord_sf(xlim = c(lon2, lon1), ylim = c(lat1, lat2), expand = FALSE)
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat,
color = as.factor(station)))
ggplot(data = basemap) +
geom_sf() +
coord_sf(xlim = c(lon2, lon1), ylim = c(lat1, lat2), expand = FALSE)
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station)))
ggplot(data = basemap) +
geom_sf(fill = "antiquwwhite") +
coord_sf(xlim = c(lon2, lon1), ylim = c(lat1, lat2), expand = FALSE) +
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station)))
ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2, lon1), ylim = c(lat1, lat2), expand = FALSE) +
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station)))
ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2, lon1), ylim = c(lat1, lat2), expand = FALSE) +
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station))) +
theme(panel.grid.major = element_line(color = gray(.5), linetype = "dashed", size = 0.5), panel.background = element_rect(fill = "aliceblue"))
ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2, lon1), ylim = c(lat1, lat2), expand = FALSE) +
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station))) +
theme(panel.grid.major = element_line(color = gray(.5), linetype = "dashed", size = 0.1), panel.background = element_rect(fill = "aliceblue"))
ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2, lon1), ylim = c(lat1, lat2), expand = FALSE) +
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station))) +
theme(panel.grid.major = element_line(color = white(.5), linetype = "dashed", size = 0.1), panel.background = element_rect(fill = "aliceblue"))
ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2, lon1), ylim = c(lat1, lat2), expand = FALSE) +
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station))) +
theme(panel.grid.major = element_line(color = white, linetype = "dashed", size = 0.1), panel.background = element_rect(fill = "aliceblue"))
?panel.grid.major
ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2, lon1), ylim = c(lat1, lat2), expand = FALSE) +
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station))) +
theme(panel.grid.major = element_line(), panel.background = element_rect(fill = "aliceblue"))
ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2 - 0.5, lon1 + 0.5), ylim = c(lat1 - 0.5, lat2 + 0.5), expand = FALSE) +
geom_point(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station))) +
theme(panel.grid.major = element_line(), panel.background = element_rect(fill = "aliceblue"))
ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2 - 0.5, lon1 + 0.5), ylim = c(lat1 - 0.5, lat2 + 0.5), expand = FALSE) +
geom_path(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station))) +
theme(panel.grid.major = element_line(), panel.background = element_rect(fill = "aliceblue"))
Drift <- as.factor(station)
ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2 - 0.5, lon1 + 0.5), ylim = c(lat1 - 0.5, lat2 + 0.5), expand = FALSE) +
geom_path(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station))) +
theme(panel.grid.major = element_line(), panel.background = element_rect(fill = "aliceblue"))
driftmap <- ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2 - 0.5, lon1 + 0.5), ylim = c(lat1 - 0.5, lat2 + 0.5), expand = FALSE) +
geom_path(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station))) +
theme(panel.grid.major = element_line(), panel.background = element_rect(fill = "aliceblue"))
driftmap
driftmap <- ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2 - 0.5, lon1 + 0.5), ylim = c(lat1 - 0.5, lat2 + 0.5), expand = FALSE) +
geom_path(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station))) +
theme(panel.grid.major = element_line(), panel.background = element_rect(fill = "aliceblue")) %>%
save.image("driftmap")
driftmap <- ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2 - 0.5, lon1 + 0.5), ylim = c(lat1 - 0.5, lat2 + 0.5), expand = FALSE) +
geom_path(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station))) +
theme(panel.grid.major = element_line(), panel.background = element_rect(fill = "aliceblue")) %>%
save.image(file = "driftmap")
save.image(file = "driftmap")
png(filename = "driftmap.png")
driftmap <- ggplot(data = basemap) +
geom_sf(fill = "antiquewhite") +
coord_sf(xlim = c(lon2 - 0.5, lon1 + 0.5), ylim = c(lat1 - 0.5, lat2 + 0.5), expand = FALSE) +
geom_path(data = tracks_sf, mapping = aes(x=long,y=lat, color = as.factor(station))) +
theme(panel.grid.major = element_line(), panel.background = element_rect(fill = "aliceblue"))
driftmap
if (!require("remotes"))
install.packages("remotes", repos = "https://cran.rstudio.org")
remotes::install_github("rstudio/bookdown")
remotes::install_github("ismayc/thesisdown")
